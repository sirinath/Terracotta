<!--

  All content copyright (c) 2003-2006 Terracotta, Inc.,
  except as may otherwise be noted in a separate copyright notice.
  All rights reserved

-->

<project name="tst_installer" default="prepare_and_run">
   <description>
    Downloads, installs, and boots a tomcat instance with a deployed sample app.
    Use 'ant -Doutput.dir=/abolute/path' to specify a build output directory. Defaults to ./output
    Use 'ant -Dtomcat.port=XXXX' to specify a listen port.  Defaults to 8080.
  </description>

   <taskdef resource="net/sf/antcontrib/antlib.xml">
      <classpath>
         <!--<pathelement location="${basedir}/../../lib/ant/ant-contrib-1.0b2.jar" />-->
      	     <pathelement location="${basedir}/../lib/ant/ant-contrib-1.0b2.jar" />
      </classpath>
   </taskdef>

   <path id="junittest.classpath">
      <pathelement location="${basedir}/client/build" />
      <fileset dir="${basedir}/client/build">         
      	<include name="tsinttest/BasicPackTest.class" />      	
      	<include name="tsinttest/DemoConsoleChatPackTest.class" />
      	<include name="tsinttest/DemoJTablePackTest.class" />     	
      	<include name="tsinttest/DemoSharedEditorTest.class" />
      	<include name="tsinttest/DemoViewerTest.class" />
      	<include name="tsinttest/DemoWebTest.class" />
      	<include name="tsinttest/DocsTest.class" />      	 
      	<include name="tsinttest/JREPackTest.class" />
      	<include name="tsinttest/LibPackTest.class" />
      	<include name="tsinttest/TomcatSandBoxPackTest.class" />
      	<include name="tsinttest/UninstallPackTest.class" />      	
      </fileset>
      <pathelement location="${build.classes}" />
   </path>
	
	<!--<property name="tvs.homedir" value="${basedir}/Terracotta/tc-sessions2.0.2"/>-->
	<property name="tvs.homedir" value="${basedir}/Terracotta/tc-sessions2.0.3"/>
	<!--<property name="tvs.server.download" value="sand.terracotta.lan" />-->
	<!--<property name="build.download.dir" value="/export2/homes/cruise/monkey/changeset-kits/irving" />-->
	<!--<property name="build.download.dir" value="/export2/homes/cruise/monkey/changeset-kits/judah" />-->
	<property name="tvs.server.download" value="fileserver.terracotta.lan" />
	<property name="build.download.dir" value="/export2/homes/cruise/monkey/candidates/judah/RC8" />
	<property name="tvs.build.name" value="tvs" />
	<property name="tvs.installer" value="${basedir}/installer" />	
	<property name="tvs.targz" value="tvs.tar.gz"/>
	<property name="tvs.tar" value="${tvs.build.name}.tar" />
	<property name="tvs.dir" value="${basedir}/TVS" />
	<property name="client.src" value="${basedir}/client/src" />
	<property name="client.build" value="${basedir}/client/build" />	
	<property name="tcdir.value" value="${basedir}/Terracotta" />
	<property name="java.dir" value="${basedir}/tsinttest" />
	<property name="src.dir" value="${client.src}/tsinttest" />
	
	<!-- Root folder files -->
	<property name="homedir.value" value="${tvs.homedir}" />		
	
	<!-- Bin folder and files -->
	<property name="bin.dir" value="${tvs.homedir}/bin" />	
	<property name="bindir.value" value="${bin.dir}"/>	
	<property name="stop-tc-server.value" value="${bin.dir}/stop-tc-server.bat"/>
	<property name="tc-admin.value" value="${bin.dir}/tc-admin.bat"/>
	<property name="tc-version.value" value="${bin.dir}/tc-version.bat"/>
	<property name="tc-configurator.value" value="${bin.dir}/tc-configurator.bat"/>	
	
	<!-- Demo folder and files -->
	<property name="demo.dir" value="${tvs.homedir}/demos" />	
	<property name="demodir.value" value="${demo.dir}"/>		
	<property name="start-demo-server.value" value="${demo.dir}/start-demo-server.bat" />
	<property name="tc-config.value" value="${demo.dir}/tc-config.xml" />	
		
	<!-- Demo/ConsoleChat folder and files -->
	<property name="ConsoleChat.dir" value="${demo.dir}/ConsoleChat" />
	<property name="Consoleclasses.dir" value="${ConsoleChat.dir}/classes" />
	<property name="Consolesrc.dir" value="${ConsoleChat.dir}/src" />
	<property name="ConsoleChatdir.value" value="${ConsoleChat.dir}" />
	<property name="Consoleclassesdir.value" value="${Consoleclasses.dir}" />
	<property name="Consolesrcdir.value" value="${Consolesrc.dir}" />	
	<property name="Consolebuild.value" value="${ConsoleChat.dir}/build.bat" />	
	<property name="Consolereadme.value" value="${ConsoleChat.dir}/README.txt" />
	<property name="Consolerundemo.value" value="${ConsoleChat.dir}/rundemo.bat" />
	<property name="Consoletcconfig.value" value="${ConsoleChat.dir}/tc-config.xml" />
			
	<!-- Demo/ConsoleChat/src folder and files -->
	<property name="Consolesrcfile.name" value="${Consolesrc.dir}/demo/consolechat" />
	<property name="Consolesrcfile.value" value="${Consolesrcfile.name}/Chatter.java" />
	
	<!-- Demo/ConsoleChat/classes folder and files -->
	<property name="Consoleclassesfolder.value" value="${Consoleclassesdir.value}/demo/consolechat" />
	
	<!-- exec and arguments -->	
	<property name="tvs.host" value="localhost" />
	<property name="tvs.port" value="9520" />
	<property name="taskkill.dir" value="C:/WINDOWS/system32/" />
	<property name="taskkill.name" value="${taskkill.dir}/taskkill.exe" />
	
	<!-- Demo/jtable folder and files -->
	<property name="jtable.dir" value="${demo.dir}/jtable" />
	<property name="jtableclasses.dir" value="${jtable.dir}/classes" />
	<property name="jtablesrc.dir" value="${jtable.dir}/src" />
	<property name="jtabledir.value" value="${jtable.dir}" />
	<property name="jtableclassesdir.value" value="${jtableclasses.dir}" />
	<property name="jtablesrcdir.value" value="${jtablesrc.dir}" />
	<property name="jtablebuild.value" value="${jtable.dir}/build.bat" />	
	<property name="jtablerundemo.value" value="${jtable.dir}/rundemo.bat" />
	
	<!-- Demo/jtable/src folder and files -->
	<property name="jtablesrcfile.name" value="${jtablesrc.dir}/demo/jtable" />
	<property name="jtablesrcfile.value" value="${jtablesrcfile.name}/TableDemo.java" />
	
	<!-- Demo/shared Editor folder and files -->
	<property name="sharedEditor.dir" value="${demo.dir}/sharedEditor" />
	<property name="sharedEditorclasses.dir" value="${sharedEditor.dir}/classes" />
	<property name="sharedEditorlib.dir" value="${sharedEditor.dir}/lib" />
	<property name="sharedEditorsrc.dir" value="${sharedEditor.dir}/src" />
	<property name="sharedEditordir.value" value="${sharedEditor.dir}" />
	<property name="sharedEditorclassesdir.value" value="${sharedEditorclasses.dir}" />
	<property name="sharedEditorlibdir.value" value="${sharedEditorlib.dir}" />	
	<property name="sharedEditorsrcdir.value" value="${sharedEditorsrc.dir}" />		
	<property name="sharedEditorbuild.value" value="${sharedEditor.dir}/build.bat" />	
	<property name="sharedEditorrundemo.value" value="${sharedEditor.dir}/rundemo.bat" />	
	
	<!-- Demo/sharedEditor/lib folder and files -->
	<property name="sharedEditorlibfile.value" value="${sharedEditorlib.dir}/forms_rt.jar" />
	
	<!-- Demo/sharedEditor/src folder and files -->
	<property name="sharedEditorsrcfile.name" value="${sharedEditorsrc.dir}/demo/sharedEditor" />
	<property name="sharedEditorsrcfile.value" value="${sharedEditorsrcfile.name}/DPane.java" />
	<property name="sharedEditorsrcbeansfile.name" value="${sharedEditorsrc.dir}/demo/sharedEditor/beans" />
	<property name="sharedEditorsrcbeansfile.value" value="${sharedEditorsrcbeansfile.name}/SharedUI.java" />
	<property name="sharedEditorsrcmodelfile.value" value="${sharedEditorsrc.dir}/demo/sharedEditor/model" />
	<property name="sharedEditorsrcuifile.name" value="${sharedEditorsrc.dir}/demo/sharedEditor/ui" />
	<property name="sharedEditorsrcuifile.value" value="${sharedEditorsrcuifile.name}/SharedUI.form" />
	<property name="sharedEditorsrcimgfile.value" value="${sharedEditorsrc.dir}/img" />
	
	<!-- Demo/viewer folder and files -->
	<property name="viewer.dir" value="${demo.dir}/viewer" />
	<property name="viewerclasses.dir" value="${viewer.dir}/classes" />
	<property name="viewerlib.dir" value="${viewer.dir}/lib" />
	<property name="viewersrc.dir" value="${viewer.dir}/src" />
	<property name="viewerdir.value" value="${viewer.dir}" />
	<property name="viewerclassesdir.value" value="${viewerclasses.dir}" />
	<property name="viewerlibdir.value" value="${viewerlib.dir}" />	
	<property name="viewersrcdir.value" value="${viewersrc.dir}" />		
	<property name="viewerbuild.value" value="${viewer.dir}/build.bat" />	
	<property name="viewerrundemo.value" value="${viewer.dir}/rundemo.bat" />	
	
	<!-- Demo/viewer/src folder and files -->
	<property name="viewersrcfile.value" value="${viewersrc.dir}/demo/viewer" />	
	<property name="viewersrcbeansfile.name" value="${viewersrc.dir}/demo/viewer/beans" />
	<property name="viewersrcbeansfile.value" value="${viewersrcbeansfile.name}/Display.java" />	
	<property name="viewersrcuifile.name" value="${viewersrc.dir}/demo/viewer/ui" />
	<property name="viewersrcuifile.value" value="${viewersrcuifile.name}/Display.form" />
	
	<!-- Demo/web folder and files -->
	<property name="web.dir" value="${demo.dir}/web" />
	<property name="webclasses.dir" value="${web.dir}/classes" />
	<property name="webdemo.dir" value="${web.dir}/demo" />
	<property name="weblib.dir" value="${web.dir}/lib" />
	<property name="websrc.dir" value="${web.dir}/src" />
	<property name="webdir.value" value="${web.dir}" />
	<property name="webclassesdir.value" value="${webclasses.dir}" />
	<property name="webdemodir.value" value="${webdemo.dir}" />
	<property name="weblibdir.value" value="${weblib.dir}" />	
	<property name="websrcdir.value" value="${websrc.dir}" />		
	<property name="webbuild.value" value="${web.dir}/build.bat" />	
	<property name="webrundemo.value" value="${web.dir}/rundemo.bat" />
	
	<!-- Demo/web/demo/image folder and files -->	
	<property name="webdemoimgfile.name" value="${webdemo.dir}/images" />
	<property name="webdemoimgfile.value" value="${webdemoimgfile.name}/terr_logo.gif" />
	
	<!-- Demo/web/src folder and files -->
	<property name="websrcfile.value" value="${websrc.dir}/demo/sharedservlet" />
	<property name="websrcexpfile.name" value="${websrcfile.value}/exception" />
	<property name="websrcexpfile.value" value="${websrcexpfile.name}/EmptyWorkQueueException.java" />	
	
	<!-- Docs folder and files -->
	<property name="docs.dir" value="${tvs.homedir}/docs" />
	<property name="docsdir.value" value="${docs.dir}" />
	
	<!-- Libexec folder and files -->
	<property name="libexec.dir" value="${tvs.homedir}/libexec" />
	<property name="libexecdir.value" value="${libexec.dir}" />
	<property name="libexecfile.value" value="${libexec.dir}/tc-functions.bat" />	
	
	<!-- sample-config folder and files -->
	<property name="sconfig.dir" value="${tvs.homedir}/sample-config" />
	<property name="sconfigdir.value" value="${sconfig.dir}" />
	<property name="sconfigfile.value" value="${sconfig.dir}/tc-config-sample.xml" />	
	
	<!-- jre folder and files -->
	<property name="jre.dir" value="${tvs.homedir}/jre" />
	<property name="jredir.value" value="${jre.dir}" />
	<property name="jrebindir.value" value="${jredir.value}/bin" />
	<property name="jrebinclientdir.value" value="${jrebindir.value}/client" />
	<property name="jrejredir.value" value="${jre.dir}/jre" />
	<property name="jrejrebindir.value" value="${jrejredir.value}/bin" />
	<property name="jrejrebinserverdir.value" value="${jrejrebindir.value}/server" />
	<property name="jrejrelibdir.value" value="${jrejredir.value}/lib" />
	<property name="jrejrelibaudiodir.value" value="${jrejrelibdir.value}/audio" />
	<property name="jrejrelibaudiodirfile.value" value="${jrejrelibaudiodir.value}/soundbank.gm" />
	<property name="jrejrelibcmmdir.value" value="${jrejrelibdir.value}/cmm" />
	<property name="jrejrelibcmmdirfile.value" value="${jrejrelibcmmdir.value}/PYCC.pf" />
	<property name="jrejrelibfontsdir.value" value="${jrejrelibdir.value}/fonts" />
	<property name="jrelibdir.value" value="${jre.dir}/lib" />
	<property name="jrelibaudiodir.value" value="${jrelibdir.value}/audio" />
	<property name="jrelibaudiodirfile.value" value="${jrelibaudiodir.value}/soundbank.gm" />
	<property name="jrelibcmmdir.value" value="${jrelibdir.value}/cmm" />
	<property name="jrelibextdir.value" value="${jrelibdir.value}/ext" />
	<property name="jrelibfontsdir.value" value="${jrelibdir.value}/fonts" />
	<property name="jrelibi386dir.value" value="${jrelibdir.value}/i386" />
	<property name="jrelibi386dirfile.value" value="${jrelibi386dir.value}/jvm.cfg" />
	<property name="jrelibimdir.value" value="${jrelibdir.value}/im" />
	<property name="jrelibimgdir.value" value="${jrelibdir.value}/images" />
	<property name="jrelibimgcursorsdir.value" value="${jrelibimgdir.value}/cursors" />
	<property name="jrelibjavawdir.value" value="${jrelibdir.value}/javaws" />
	<property name="jrelibmanagdir.value" value="${jrelibdir.value}/management" />
	<property name="jrelibsecurdir.value" value="${jrelibdir.value}/security" />
	<property name="jrelibzidir.value" value="${jrelibdir.value}/zi" />
	
	<!-- lib folder and files -->
	<property name="lib.dir" value="${tvs.homedir}/lib" />
	<property name="libdir.value" value="${lib.dir}" />
	<property name="libdsodir.value" value="${libdir.value}/dso-boot" />
	<property name="libtomcatdir.value" value="${libdir.value}/tomcat" />
	<property name="libtomcatdirfile.value" value="${libtomcatdir.value}/tc-tomcat-dso-boot.jar" />
	<property name="libweblogicdir.value" value="${libdir.value}/weblogic" />
	<property name="libweblogicdirfile.value" value="${libweblogicdir.value}/tc-weblogic-dso-boot.jar" />
	
	<!-- tomcat-sandbox folder and files -->
	<property name="tomsandbox.dir" value="${tvs.homedir}/tomcat-sandbox" />
	<property name="tomsandboxdir.value" value="${tomsandbox.dir}" />
	<property name="tomsandboxbindir.value" value="${tomsandbox.dir}/bin" />
	<!-- tomcat-8081 folder and files -->
	<property name="tomtom9081dir.value" value="${tomsandbox.dir}/tomcat-9081" />
	<property name="tomtom9081bindir.value" value="${tomtom9081dir.value}/bin" />
	<property name="tomtom9081commondir.value" value="${tomtom9081dir.value}/common" />
	<property name="tomtom9081commonendorsedir.value" value="${tomtom9081commondir.value}/endorsed" />
	<property name="tomtom9081commonlibdir.value" value="${tomtom9081commondir.value}/lib" />
	<property name="tomtom9081confdir.value" value="${tomtom9081dir.value}/conf" />
	<property name="tomtom9081confcatalinalocalhostdir.value" value="${tomtom9081confdir.value}/Catalina/localhost" />
	<property name="tomtom9081serverdir.value" value="${tomtom9081dir.value}/server" />
	<property name="tomtom9081serverlibdir.value" value="${tomtom9081serverdir.value}/lib" />
	<property name="tomtom9081serverwebappsdir.value" value="${tomtom9081serverdir.value}/webapps" />
	<property name="tomtom9081webappsadmindir.value" value="${tomtom9081serverwebappsdir.value}/admin" />
	<property name="tomtom9081webappsadminimgdir.value" value="${tomtom9081webappsadmindir.value}/images" />
	<property name="tomtom9081webappsadminresdir.value" value="${tomtom9081webappsadmindir.value}/resources" />
	<property name="tomtom9081webappsadminusersdir.value" value="${tomtom9081webappsadmindir.value}/users" />
	<property name="tomtom9081webappsadminwebinfdir.value" value="${tomtom9081webappsadmindir.value}/WEB-INF" />
	<property name="tomtom9081webappsadminwebinflibdir.value" value="${tomtom9081webappsadminwebinfdir.value}/lib" />
	<property name="tomtom9081webappsmangdir.value" value="${tomtom9081serverwebappsdir.value}/manager" />
	<property name="tomtom9081webappsmangimgdir.value" value="${tomtom9081webappsmangdir.value}/images" />
	<property name="tomtom9081webappsmanginfdir.value" value="${tomtom9081webappsmangdir.value}/WEB-INF" />
	<property name="tomtom9081webappsmanginflibdir.value" value="${tomtom9081webappsmanginfdir.value}/lib" />
	<property name="tomtom9081webappsdir.value" value="${tomtom9081dir.value}/webapps" />
	<property name="tomtom9081webappsrootdir.value" value="${tomtom9081webappsdir.value}/ROOT" />
	<property name="tomtom9081webappsrootinfdir.value" value="${tomtom9081webappsrootdir.value}/WEB-INF" />
	<property name="tomtom9081webappsrootinflibdir.value" value="${tomtom9081webappsrootinfdir.value}/lib" />
	
	<!-- tomcat-8082 folder and files -->	
	<property name="tomtom9082dir.value" value="${tomsandbox.dir}/tomcat-9082" />
	<property name="tomtom9082bindir.value" value="${tomtom9082dir.value}/bin" />
	<property name="tomtom9082commondir.value" value="${tomtom9082dir.value}/common" />
	<property name="tomtom9082commonendorsedir.value" value="${tomtom9082commondir.value}/endorsed" />
	<property name="tomtom9082commonlibdir.value" value="${tomtom9082commondir.value}/lib" />
	<property name="tomtom9082confdir.value" value="${tomtom9082dir.value}/conf" />
	<property name="tomtom9082confcatalinalocalhostdir.value" value="${tomtom9082confdir.value}/Catalina/localhost" />
	<property name="tomtom9082serverdir.value" value="${tomtom9082dir.value}/server" />
	<property name="tomtom9082serverlibdir.value" value="${tomtom9082serverdir.value}/lib" />
	<property name="tomtom9082serverwebappsdir.value" value="${tomtom9082serverdir.value}/webapps" />
	<property name="tomtom9082webappsadmindir.value" value="${tomtom9082serverwebappsdir.value}/admin" />
	<property name="tomtom9082webappsadminimgdir.value" value="${tomtom9082webappsadmindir.value}/images" />
	<property name="tomtom9082webappsadminresdir.value" value="${tomtom9082webappsadmindir.value}/resources" />
	<property name="tomtom9082webappsadminusersdir.value" value="${tomtom9082webappsadmindir.value}/users" />
	<property name="tomtom9082webappsadminwebinfdir.value" value="${tomtom9082webappsadmindir.value}/WEB-INF" />
	<property name="tomtom9082webappsadminwebinflibdir.value" value="${tomtom9082webappsadminwebinfdir.value}/lib" />
	<property name="tomtom9082webappsmangdir.value" value="${tomtom9082serverwebappsdir.value}/manager" />
	<property name="tomtom9082webappsmangimgdir.value" value="${tomtom9082webappsmangdir.value}/images" />
	<property name="tomtom9082webappsmanginfdir.value" value="${tomtom9082webappsmangdir.value}/WEB-INF" />
	<property name="tomtom9082webappsmanginflibdir.value" value="${tomtom9082webappsmanginfdir.value}/lib" />
	<property name="tomtom9082webappsdir.value" value="${tomtom9082dir.value}/webapps" />
	<property name="tomtom9082webappsrootdir.value" value="${tomtom9082webappsdir.value}/ROOT" />
	<property name="tomtom9082webappsrootinfdir.value" value="${tomtom9082webappsrootdir.value}/WEB-INF" />
	<property name="tomtom9082webappsrootinflibdir.value" value="${tomtom9082webappsrootinfdir.value}/lib" />
	
	<property name="startall.value" value="${tomsandboxbindir.value}/start-all.bat" />
	<property name="stopall.value" value="${tomsandboxbindir.value}/stop-all.bat" />
	<property name="tomsandboxstarttc.value" value="${tomsandboxbindir.value}/start-tc-server.bat" />
	<property name="tomsandboxstarttomcat81.value" value="${tomsandboxbindir.value}/start-tomcat-9081.bat" />
	<property name="tomsandboxstarttomcat82.value" value="${tomsandboxbindir.value}/start-tomcat-9082.bat" />
	<property name="tomsandboxstoptc.value" value="${tomsandboxbindir.value}/stop-tc-server.bat" />
	<property name="tomsandboxstoptomcat81.value" value="${tomsandboxbindir.value}/stop-tomcat-9081.bat" />
	<property name="tomsandboxstoptomcat82.value" value="${tomsandboxbindir.value}/stop-tomcat-9082.bat" />
	
	<!-- Uninstall folder and files -->
	<property name="uninstall.dir" value="${tcdir.value}/uninstall" />
	<property name="uninstalldir.value" value="${uninstall.dir}" />
	<property name="uninstallresdir.value" value="${uninstall.dir}/resource" />
	
	<if>
	      <os family="unix" />
	      <then>
	         <property name="tvs.start" value="start-tc-server" />
	         <property name="tvs.stop" value="stop-tc-server" />
	         <property name="dso-boot.jar" value="${tvs.homedir}/lib/dso-boot/dso-boot-hotspot_linux_142.jar"/>
	      </then>
	      <else>
	         <property name="tvs.start" value="start-tc-server.bat" />
	         <property name="tvs.stop" value="stop-tc-server.bat" />
	         <property name="dso-boot.jar" value="${tvs.homedir}/lib/dso-boot/dso-boot-hotspot_win32_150.jar"/>
	         <property name="tvs.win" value="true" />
	      </else>
	</if>
	
	<target name="clean" description="Remove the folders">	      
	      <delete dir="${basedir}/junitreports" />
	      <delete dir="${basedir}/reports" />
	      <delete dir="${basedir}/report" />	      
	      <delete dir="${tcdir.value}" />
		  <delete dir="${tvs.dir}" />
	   	  <delete dir="${basedir}/client/build" />
		  <delete dir="${tvs.installer}" />
		  <delete file="${basedir}/version.txt" />
		  <delete dir="${client.src}" />
		  <delete dir="${basedir}/client" />
		
		
	</target>	
	
	<!-- for running pack test -->
	<!--<target name="prepare_and_run" depends="init, download.tvs, compile_client, deployversion.scripts">-->
	<target name="prepare_and_run" depends="init, download.tvs, compile_client, deployversion.scripts">
	
	<!-- for running all servers for sessions -->
	<!--<target name="prepare_and_run" depends="init, download.tvs, start.tcconfig">-->
	
	<!-- for running all servers one by one for sessions -->
	<!-- <target name="prepare_and_run" depends="init, download.tvs, start.tcconfig ">-->
		
		<!-- for running pack test-->
		<sequential> 				        
			<antcall target="test_and_report" />
		</sequential>
		
		<!-- for running all servers for sessions -->
		<!--<sequential>
				<sleep seconds="60"/>
				<antcall target="start.allservers" />				
			</sequential>
			<sequential> 				        
				<antcall target="test_and_report" />
			</sequential>
			<sequential>
	          <sleep seconds="60"/>				
				<antcall target="shutdown_sessionallservers" />				
		   </sequential>-->
			
		    <!-- for running demos -->
		<!--<sequential> 				        
				<antcall target="test_and_report" />
			</sequential>
		<sequential>
             <sleep seconds="60"/>
            <antcall target="shutdown_servers" />
        </sequential>-->	
			
		<!-- for running all servers one by one for sessions -->
		<!--<sequential>
			<sleep seconds="120"/>
			<antcall target="startsession.servers" />				
		</sequential>	
		<sequential> 				        
			<antcall target="test_and_report" />
		</sequential>
		<sequential>
          <sleep seconds="120"/>				
			<antcall target="shutdownsession.servers" />
        </sequential>-->	
		
		
	</target>
		
	<target name="init">		      
			  <available file="${tvs.homedir}" property="tvs.homedir.exists" />      
			  <mkdir dir="${basedir}/reports" />
		      <mkdir dir="${basedir}/junitreports" />
		      <mkdir dir="${basedir}/report/html" />
			  <mkdir dir="${tvs.dir}" />
		      <mkdir dir="${basedir}/client/build" />
		      <mkdir dir="${basedir}/client/src/tsinttest" />
			  <mkdir dir="${tvs.installer}" />
		      <mkdir dir="${tcdir.value}" />
		      <copydir src="${java.dir}" dest="${src.dir}"/>
	</target>
		
	<target name="download.tvs" unless="tvs.homedir.exists">   	
		 <if><isset property="tvs.win"/>
		<then>
			<sshexec host="${tvs.server.download}"
			    	      	username="cruise"
			    	      	password="cruise"
			    	      	trust="yes"
			    			command="ls -ltr ${build.download.dir}/tc*.exe |awk '$0 !~ /lehman/' | awk '{field=$NF} END {print field}'"
			    	        outputproperty="tvsexe" />
			    	        <echo message="********************************************"/>
			    	        <echo message="${tvsexe}"/>
			    	        <scp file="cruise:cruise@${tvs.server.download}:${tvsexe}"  localTofile="${tvs.installer}" trust="yes"/> 
			    	        
		</then>
		<else>	    	      
			<sshexec host="${tvs.server.download}"
			    	            	username="cruise"
			    	            	password="cruise"
			    	            	trust="yes"
			    	      			command="ls -ltr ${build.download.dir}/tc*.gz |awk '$0 !~ /lehman/' | awk '{field=$NF} END {print field}'"
			    	                outputproperty="tvs.tar.gz" />
			    	                <echo message="********************************************"/>
			    	                <echo message="${tvs.tar.gz}"/>
			    	       			<scp file="cruise:cruise@${tvs.server.download}:${tvs.tar.gz}"  trust="yes" localTofile="${tvs.targz}"/> 
			    			<gunzip src="${basedir}/${tvs.targz}" dest="${basedir}/${tvs.tar}"/>
			    			<untar src="${basedir}/${tvs.tar}" dest="${basedir}"/>			    
			    			<exec dir="${tvs.dir}" executable="ls" outputproperty="tvs.targz">
			    			</exec>			     			
			    	      	<echo message="TVS downloaded file is:"/>
			     			<echo message="${tvs.targz}"/>			    
		</else>
		</if>
	 </target>
	
	<target name="compile_client">
		      <chmod dir="${client.build}" perm="777" />
		      <javac srcdir="${client.src}" destdir="${client.build}" />
	</target>	
	
	<target name="consolechatcompile.app">
		      <delete dir="${ConsoleChat.dir}/classes" />
			  <echo message="successfully deleted the folder: ${ConsoleChat.dir}/classes" />
		      <echo message="Compling the console chat app ${ConsoleChat.dir}" />		      
		      <echo message="Starting build.bat: ${Consolebuild.value}" />
		      <exec dir="${ConsoleChat.dir}" executable="${Consolebuild.value}" spawn="true">		         
		      </exec>
	</target>
	
	<target name="jtablecompile.app">
			      <delete dir="${jtable.dir}/classes" />
				  <echo message="successfully deleted the folder: ${jtable.dir}/classes" />
			      <echo message="Compling the jtable app ${jtable.dir}" />		      
			      <echo message="Starting build.bat: ${jtablebuild.value}" />
			      <exec dir="${jtable.dir}" executable="${jtablebuild.value}" spawn="true">		         
			      </exec>
	</target>
	
	<target name="sharedEditorcompile.app">
				   <delete dir="${sharedEditor.dir}/classes" />
				   <echo message="successfully deleted the folder: ${sharedEditor.dir}/classes" />
				   <echo message="Compling the shared Editor app ${sharedEditor.dir}" />		      
				   <echo message="Starting build.bat: ${sharedEditorbuild.value}" />
				   <exec dir="${sharedEditor.dir}" executable="${sharedEditorbuild.value}" spawn="true">		         
				   </exec>
	</target>
	
	<target name="viewercompile.app">
				<delete dir="${viewer.dir}/classes" />
				<echo message="successfully deleted the folder: ${viewer.dir}/classes" />
				<echo message="Compling the viewer app ${viewer.dir}" />		      
				<echo message="Starting build.bat: ${viewerbuild.value}" />
				<exec dir="${viewer.dir}" executable="${viewerbuild.value}" spawn="true">		         
				</exec>
	</target>
	
	<target name="webcompile.app">
			<delete dir="${web.dir}/classes" />
			<echo message="successfully deleted the folder: ${web.dir}/classes" />
			<echo message="Compling the web app ${web.dir}" />		      
			<echo message="Starting build.bat: ${webbuild.value}" />
			<exec dir="${web.dir}" executable="${webbuild.value}" spawn="true">		         
			</exec>
	</target>
	
	<target name="start.tcadmin">
		<echo message="Starting terracotta console by running tc.admin.bat: ${tc-admin.value}" />
		<chmod file="${tc-admin.value}" perm="777" />
		<exec dir="${bin.dir}" executable="${tc-admin.value}" spawn="true">			
		</exec>		
	</target>
	
	<target name="start.tcconfig">
			<echo message="Starting terracotta session configurator by running tc.configurator.bat: ${tc-configurator.value}" />
		    <chmod file="${tc-configurator.value}" perm="777" />	
		    <exec dir="${bin.dir}" executable="${tc-configurator.value}" spawn="true">			
			</exec>		
	</target>
	
	<target name="start.tvs">		    
		 <echo message="Starting TVS server from ${start-demo-server.value}" />
		<chmod file="${start-demo-server.value}" perm="777" />
		 <exec dir="${demo.dir}" executable="${start-demo-server.value}" spawn="true">		 	
		 </exec>
	</target>
	
	<target name="start.allservers">		    
			 <echo message="Starting TVS server, tomcat 9081 and tomcat 9082 from ${startall.value}" />
			<chmod file="${startall.value}" perm="777" />
			 <exec dir="${tomsandboxbindir.value}" executable="${startall.value}" spawn="true">		 	
			 </exec>
	</target>
	
	<target name="startsession.servers" depends="starttc.server, starttomcat81.server, starttomcat82.server" />	
	    <target name="starttc.server">
			<echo message="Starting TVS server from ${tomsandboxstarttc.value}" />
			<chmod file="${tomsandboxstarttc.value}" perm="777" />
		 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstarttc.value}" spawn="true">		 	
		 	</exec>		
	   </target>
	  <target name="starttomcat81.server">
				<echo message="Starting tomcat 9081 server from ${tomsandboxstarttomcat81.value}" />
				<chmod file="${tomsandboxstarttomcat81.value}" perm="777" />
			 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstarttomcat81.value}" spawn="true">		 	
			 	</exec>		
	 </target>
	<target name="starttomcat82.server">
					<echo message="Starting tomcat 9082 server from ${tomsandboxstarttomcat82.value}" />
					<chmod file="${tomsandboxstarttomcat82.value}" perm="777" />
				 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstarttomcat82.value}" spawn="true">		 	
				 	</exec>		
	</target>
	
	
	<target name="deployconsolechat.app">		    
		<echo message="Starting the demo from ${Consolerundemo.value}" />
		<chmod file="${Consolerundemo.name}" perm="777" />
		<exec dir="${ConsoleChat.dir}" executable="${Consolerundemo.value}" spawn="true">		  
		</exec>
   </target>
	
	<target name="deployconsolechat.app1">		    
			<echo message="Starting the demo from ${Consolerundemo.value}" />
			<chmod file="${Consolerundemo.value}" perm="777" />
			<exec dir="${ConsoleChat.dir}" executable="${Consolerundemo.value}" spawn="true">
			</exec>
		    <!--Note: Modified rundemo.bat with "%*" into "kalai"-->
		    <!--Note: Modified Chatter.java, In class MessageObject, String message = ""; and String username = ""; into String message = "hi"; and String username = "kalai";-->
		  
	</target>
	
	<target name="deployjtable.app">		    
				<echo message="Starting the demo from ${jtablerundemo.value}" />
				<chmod file="${jtablerundemo.value}" perm="777" />
				<exec dir="${jtable.dir}" executable="${jtablerundemo.value}" spawn="true">
				</exec>  
	</target>
	
	<target name="deployjtable.app1">		    
				<echo message="Starting the demo from ${jtablerundemo.value}" />
				<chmod file="${jtablerundemo.value}" perm="777" />
				<exec dir="${jtable.dir}" executable="${jtablerundemo.value}" spawn="true">
				</exec>  
	</target>
	
	<target name="deploysharedEditor.app">		    
					<echo message="Starting the demo from ${sharedEditorrundemo.value}" />
					<chmod file="${sharedEditorrundemo.value}" perm="777" />
					<exec dir="${sharedEditor.dir}" executable="${sharedEditorrundemo.value}" spawn="true">
					</exec>  
	</target>
		
	<target name="deploysharedEditor.app1">		    
		<echo message="Starting the demo from ${sharedEditorrundemo.value}" />
		<chmod file="${sharedEditorrundemo.value}" perm="777" />
		<exec dir="${sharedEditor.dir}" executable="${sharedEditorrundemo.value}" spawn="true">
		</exec>  
	</target>
	
	<target name="deployviewer.app">		    
			<echo message="Change jdbc-enabled to true in the ${tc-config.value}" />		    
			<echo message="Uncommented database listener and enter database listener host to test16.terracotta.lan in the ${tc-config.value}" />		
			<echo message="Starting the demo from ${viewerrundemo.value}" />
			<chmod file="${viewerrundemo.value}" perm="777" />
			<exec dir="${viewer.dir}" executable="${viewerrundemo.value}" spawn="true">
				<arg line="test16.terracotta.lan 1521 TESTDB test test" />
			</exec>  
	</target>
			
	<target name="deployviewer.app1">		    
			<echo message="Starting the demo from ${viewerrundemo.value}" />
			<chmod file="${viewerrundemo.value}" perm="777" />
			<exec dir="${viewer.dir}" executable="${viewerrundemo.value}" spawn="true">
				<arg line="test16.terracotta.lan 1521 TESTDB test test" />
			</exec>  
	</target>
	
	<target name="deployweb.app">
				<echo message="Starting the demo from ${webrundemo.value}" />
				<chmod file="${webrundemo.value}" perm="777" />
				<exec dir="${web.dir}" executable="${webrundemo.value}" spawn="true">
					<arg line="8051" />
				</exec>  
	</target>
				
		<target name="deployweb.app1">		    
				<echo message="Starting the demo from ${webrundemo.value}" />
				<chmod file="${webrundemo.value}" perm="777" />
				<exec dir="${web.dir}" executable="${webrundemo.value}" spawn="true">
					<arg line="8052" />
				</exec>  
		</target>
	
	<target name="deployversion.scripts">			
				<echo message="Starting tc version from ${tc-version.value}" />
				<chmod file="${tc-version.value}" perm="777" />
				 <exec dir="${bin.dir}" executable="${tc-version.value}" output="version.txt">
				 	<arg line="-v" />
				 </exec>
   </target>	
	
	
	<target name="test_and_report" depends="run_junit, make_junit_report" />
		
	<target name="run_junit">
		      <junit printsummary="yes" haltonfailure="no" fork="yes">
		         <classpath refid="junittest.classpath" />
		      	<jvmarg value="-Dtcdir.value=${tcdir.value}" />		      	
		      	
		      	<jvmarg value="-Dhomedir.value=${homedir.value}" />		      	
		      	
		      	<jvmarg value="-Dbindir.value=${bindir.value}" />		      	
		      	
		      	<jvmarg value="-Ddemodir.value=${demodir.value}" />		      	
		      	
		      	<jvmarg value="-DConsoleChatdir.value=${ConsoleChatdir.value}" />
		      	<jvmarg value="-DConsoleclassesdir.value=${Consoleclassesdir.value}" />
		      	<jvmarg value="-DConsolesrcdir.value=${Consolesrcdir.value}" />
		      	<jvmarg value="-DConsolebuild.value=${Consolebuild.value}" />
		      	<jvmarg value="-DConsolereadme.value=${Consolereadme.value}" />
		      	<jvmarg value="-DConsolerundemo.value=${Consolerundemo.value}" />
		      	<jvmarg value="-DConsoletcconfig.value=${Consoletcconfig.value}" />		      	
		      	<jvmarg value="-DConsolesrcfile.value=${Consolesrcfile.value}" />
		      	<jvmarg value="-DConsoleclassesfolder.value=${Consoleclassesfolder.value}" />
		      	
		      	<jvmarg value="-Djtabledir.value=${jtabledir.value}" />
		      	<jvmarg value="-Djtableclassesdir.value=${jtableclassesdir.value}" />
		      	<jvmarg value="-Djtablesrcdir.value=${jtablesrcdir.value}" />
		      	<jvmarg value="-Djtablesrcfile.value=${jtablesrcfile.value}" />
		      	
		      	<jvmarg value="-DsharedEditordir.value=${sharedEditordir.value}" />
		      	<jvmarg value="-DsharedEditorclassesdir.value=${sharedEditorclassesdir.value}" />
		      	<jvmarg value="-DsharedEditorlibdir.value=${sharedEditorlibdir.value}" />
		      	<jvmarg value="-DsharedEditorsrcdir.value=${sharedEditorsrcdir.value}" />
		      	<jvmarg value="-DsharedEditorlibfile.value=${sharedEditorlibfile.value}" />
		      	<jvmarg value="-DsharedEditorsrcfile.value=${sharedEditorsrcfile.value}" />
		      	<jvmarg value="-DsharedEditorsrcbeansfile.value=${sharedEditorsrcbeansfile.value}" />
		      	<jvmarg value="-DsharedEditorsrcmodelfile.value=${sharedEditorsrcmodelfile.value}" />
		      	<jvmarg value="-DsharedEditorsrcuifile.value=${sharedEditorsrcuifile.value}" />
		      	<jvmarg value="-DsharedEditorsrcimgfile.value=${sharedEditorsrcimgfile.value}" />
		      	
		      	<jvmarg value="-Dviewerdir.value=${viewerdir.value}" />
		      	<jvmarg value="-Dviewerclassesdir.value=${viewerclassesdir.value}" />
		      	<jvmarg value="-Dviewerlibdir.value=${viewerlibdir.value}" />
		      	<jvmarg value="-Dviewersrcdir.value=${viewersrcdir.value}" />
		      	<jvmarg value="-Dviewersrcfile.value=${viewersrcfile.value}" />
		      	<jvmarg value="-Dviewersrcbeansfile.value=${viewersrcbeansfile.value}" />
		      	<jvmarg value="-Dviewersrcuifile.value=${viewersrcuifile.value}" />
		      	
		      	<jvmarg value="-Dwebdir.value=${webdir.value}" />
		      	<jvmarg value="-Dwebclassesdir.value=${webclassesdir.value}" />
		      	<jvmarg value="-Dwebdemodir.value=${webdemodir.value}" />		      	
		      	<jvmarg value="-Dweblibdir.value=${weblibdir.value}" />
		      	<jvmarg value="-Dwebsrcdir.value=${websrcdir.value}" />		      	
		      	<jvmarg value="-Dwebdemoimgfile.value=${webdemoimgfile.value}" />
		      	<jvmarg value="-Dwebsrcfile.value=${websrcfile.value}" />
		      	<jvmarg value="-Dwebsrcexpfile.value=${websrcexpfile.value}" />
		      	
		      	<jvmarg value="-Ddocsdir.value=${docsdir.value}" />
		      	
		      	<jvmarg value="-Dlibexecdir.value=${libexecdir.value}" />
		      	<jvmarg value="-Dlibexecfile.value=${libexecfile.value}" />
		      	
		      	<jvmarg value="-Dsconfigdir.value=${sconfigdir.value}" />
		      	<jvmarg value="-Dsconfigfile.value=${sconfigfile.value}" />
		      	
		      	<jvmarg value="-Djredir.value=${jredir.value}" />
		      	<jvmarg value="-Djrebindir.value=${jrebindir.value}" />
		      	<jvmarg value="-Djrebinclientdir.value=${jrebinclientdir.value}" />
		      	<jvmarg value="-Djrejredir.value=${jrejredir.value}" />
		      	<jvmarg value="-Djrejrebindir.value=${jrejrebindir.value}" />
		      	<jvmarg value="-Djrejrebinserverdir.value=${jrejrebinserverdir.value}" />
		      	<jvmarg value="-Djrejrelibdir.value=${jrejrelibdir.value}" />
		      	<jvmarg value="-Djrejrelibaudiodirfile.value=${jrejrelibaudiodirfile.value}" />
		      	<jvmarg value="-Djrejrelibcmmdirfile.value=${jrejrelibcmmdirfile.value}" />
		      	<jvmarg value="-Djrejrelibfontsdir.value=${jrejrelibfontsdir.value}" />
		      	<jvmarg value="-Djrelibdir.value=${jrelibdir.value}" />
		      	<jvmarg value="-Djrelibaudiodirfile.value=${jrelibaudiodirfile.value}" /> 
		      	<jvmarg value="-Djrelibcmmdir.value=${jrelibcmmdir.value}" />
		      	<jvmarg value="-Djrelibextdir.value=${jrelibextdir.value}" />
		      	<jvmarg value="-Djrelibfontsdir.value=${jrelibfontsdir.value}" />
		      	<jvmarg value="-Djrelibi386dirfile.value=${jrelibi386dirfile.value}" />
		      	<jvmarg value="-Djrelibimdir.value=${jrelibimdir.value}" />
		      	<jvmarg value="-Djrelibimgcursorsdir.value=${jrelibimgcursorsdir.value}" />
		      	<jvmarg value="-Djrelibjavawdir.value=${jrelibjavawdir.value}" />
		      	<jvmarg value="-Djrelibmanagdir.value=${jrelibmanagdir.value}" />
		      	<jvmarg value="-Djrelibsecurdir.value=${jrelibsecurdir.value}" />
		      	<jvmarg value="-Djrelibzidir.value=${jrelibzidir.value}" />
		      	
		      	<jvmarg value="-Dlibdir.value=${libdir.value}" />
		      	<jvmarg value="-Dlibdsodir.value=${libdsodir.value}" />
		      	<jvmarg value="-Dlibtomcatdir.value=${libtomcatdir.value}" />
		      	<jvmarg value="-Dlibtomcatdirfile.value=${libtomcatdirfile.value}" />
		      	<jvmarg value="-Dlibweblogicdir.value=${libweblogicdir.value}" />
		      	<jvmarg value="-Dlibweblogicdirfile.value=${libweblogicdirfile.value}" />  
		      	
		      	<jvmarg value="-Dtomsandboxdir.value=${tomsandboxdir.value}" />
		      	<jvmarg value="-Dtomsandboxbindir.value=${tomsandboxbindir.value}" />
		      	<jvmarg value="-Dtomtom9081dir.value=${tomtom9081dir.value}" />
		      	<jvmarg value="-Dtomtom9081bindir.value=${tomtom9081bindir.value}" />
		      	<jvmarg value="-Dtomtom9081commondir.value=${tomtom9081commondir.value}" />
		      	<jvmarg value="-Dtomtom9081commonendorsedir.value=${tomtom9081commonendorsedir.value}" />
		      	<jvmarg value="-Dtomtom9081commonlibdir.value=${tomtom9081commonlibdir.value}" />
		      	<jvmarg value="-Dtomtom9081confdir.value=${tomtom9081confdir.value}" />
		      	<jvmarg value="-Dtomtom9081confcatalinalocalhostdir.value=${tomtom9081confcatalinalocalhostdir.value}" />
		      	<jvmarg value="-Dtomtom9081serverdir.value=${tomtom9081serverdir.value}" />
		      	<jvmarg value="-Dtomtom9081serverlibdir.value=${tomtom9081serverlibdir.value}" />
		      	<jvmarg value="-Dtomtom9081serverwebappsdir.value=${tomtom9081serverwebappsdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadmindir.value=${tomtom9081webappsadmindir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadminimgdir.value=${tomtom9081webappsadminimgdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadminresdir.value=${tomtom9081webappsadminresdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadminusersdir.value=${tomtom9081webappsadminusersdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadminwebinfdir.value=${tomtom9081webappsadminwebinfdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsadminwebinflibdir.value=${tomtom9081webappsadminwebinflibdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsmangdir.value=${tomtom9081webappsmangdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsmangimgdir.value=${tomtom9081webappsmangimgdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsmanginfdir.value=${tomtom9081webappsmanginfdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsmanginflibdir.value=${tomtom9081webappsmanginflibdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsdir.value=${tomtom9081webappsdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsrootdir.value=${tomtom9081webappsrootdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsrootinfdir.value=${tomtom9081webappsrootinfdir.value}" />
		      	<jvmarg value="-Dtomtom9081webappsrootinflibdir.value=${tomtom9081webappsrootinflibdir.value}" /> 		      	
		      	
		      	<jvmarg value="-Dtomtom9082dir.value=${tomtom9082dir.value}" />
		      	<jvmarg value="-Dtomtom9082bindir.value=${tomtom9082bindir.value}" />
		      	<jvmarg value="-Dtomtom9082commondir.value=${tomtom9082commondir.value}" />
		      	<jvmarg value="-Dtomtom9082commonendorsedir.value=${tomtom9082commonendorsedir.value}" />
		      	<jvmarg value="-Dtomtom9082commonlibdir.value=${tomtom9082commonlibdir.value}" />
		      	<jvmarg value="-Dtomtom9082confdir.value=${tomtom9082confdir.value}" />
		      	<jvmarg value="-Dtomtom9082confcatalinalocalhostdir.value=${tomtom9082confcatalinalocalhostdir.value}" />
		      	<jvmarg value="-Dtomtom9082serverdir.value=${tomtom9082serverdir.value}" />
		      	<jvmarg value="-Dtomtom9082serverlibdir.value=${tomtom9082serverlibdir.value}" />
		      	<jvmarg value="-Dtomtom9082serverwebappsdir.value=${tomtom9082serverwebappsdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadmindir.value=${tomtom9082webappsadmindir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadminimgdir.value=${tomtom9082webappsadminimgdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadminresdir.value=${tomtom9082webappsadminresdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadminusersdir.value=${tomtom9082webappsadminusersdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadminwebinfdir.value=${tomtom9082webappsadminwebinfdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsadminwebinflibdir.value=${tomtom9082webappsadminwebinflibdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsmangdir.value=${tomtom9082webappsmangdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsmangimgdir.value=${tomtom9082webappsmangimgdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsmanginfdir.value=${tomtom9082webappsmanginfdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsmanginflibdir.value=${tomtom9082webappsmanginflibdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsdir.value=${tomtom9082webappsdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsrootdir.value=${tomtom9082webappsrootdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsrootinfdir.value=${tomtom9082webappsrootinfdir.value}" />
		      	<jvmarg value="-Dtomtom9082webappsrootinflibdir.value=${tomtom9082webappsrootinflibdir.value}" />	      			      	
		      	
		      	<jvmarg value="-Duninstalldir.value=${uninstalldir.value}" />
		      	<jvmarg value="-Duninstallresdir.value=${uninstallresdir.value}" />		      	
		      	
		         <formatter type="plain" />
		         <formatter type="xml" />
		         <batchtest todir="./reports">
		            <fileset dir="${client.build}">
		            	<include name="tsinttest/BasicPackTest.class" />
		            	<include name="tsinttest/DemoConsoleChatPackTest.class" />  
		            	<include name="tsinttest/DemoJTablePackTest.class" />
		            	<include name="tsinttest/DemoSharedEditorTest.class" />
		            	<include name="tsinttest/DemoViewerTest.class" />
		            	<include name="tsinttest/DemoWebTest.class" />
		            	<include name="tsinttest/DocsTest.class" />		            	
		            	<include name="tsinttest/JREPackTest.class" />
		            	<include name="tsinttest/LibPackTest.class" />
		            	<include name="tsinttest/TomcatSandBoxPackTest.class" />
		            	<include name="tsinttest/UninstallPackTest.class" />
		            </fileset>
		         </batchtest>
		      </junit>
		</target>
		
		<target name="make_junit_report">
		      <junitreport todir="./junitreports">
		         <fileset dir="${basedir}/reports">
		            <include name="*.xml" />
		         </fileset>

		         <fileset dir="${basedir}/junitreports">
		            <include name="TEST-*.xml" />
		         </fileset>
		         <!--<report format="frames" todir="./report/html"/>-->
		         <report format="noframes" todir="./report/html" />
		      </junitreport>
		</target>
	
	<target name="shutdown_servers" depends="stop.tvs"/>
	<target name="stop.tvs">
		      <echo message="Stopping TVS server in ${stop-tc-server.value}" />
		      <chmod file="${stop-tc-server.value}" perm="777" />	      
		      <exec dir="${bin.dir}" executable="${stop-tc-server.value}">
		         <arg line="${tvs.host} ${tvs.port}" />
		      </exec>
				<echo message="closing the tc admin console and Removing all the clients" />
				<exec dir="${taskkill.dir}" executable="${taskkill.name}">
				         <arg line="/F /IM java.exe" />
			   </exec>		
	</target>
	<target name="shutdown_sessionallservers" depends="stopall.servers"/>
		<target name="stopall.servers">
			      <echo message="Stopping Teracotta server, tomcat 9081 and tomcat 9082 from ${stopall.value}" />
			      <chmod file="${stopall.value}" perm="777" />	      
			      <exec dir="${tomsandboxbindir.value}" executable="${stopall.value}" spawn="true">			         
			      </exec>
					<echo message="closing the tc admin console and Removing all the clients" />
					<exec dir="${taskkill.dir}" executable="${taskkill.name}">
					         <arg line="/F /IM java.exe" />
				   </exec>		
	</target>
	
	<target name="shutdownsession.servers" depends="stoptc.server, stoptomcat81.server, stoptomcat82.server" />	
		    <target name="stoptc.server">
				<echo message="Stopping Teracotta server from ${tomsandboxstoptc.value}" />
				<chmod file="${tomsandboxstoptc.value}" perm="777" />
			 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstoptc.value}" spawn="true">		 	
			 	</exec>		
		   </target>
		  <target name="stoptomcat81.server">
					<echo message="Starting tomcat 9081 server from ${tomsandboxstoptomcat81.value}" />
					<chmod file="${tomsandboxstoptomcat81.value}" perm="777" />
				 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstoptomcat81.value}" spawn="true">		 	
				 	</exec>		
		 </target>
		<target name="stoptomcat82.server">
						<echo message="Starting tomcat 9082 server from ${tomsandboxstoptomcat82.value}" />
						<chmod file="${tomsandboxstoptomcat82.value}" perm="777" />
					 	<exec dir="${tomsandboxbindir.value}" executable="${tomsandboxstoptomcat82.value}" spawn="true">		 	
					 	</exec>
						<echo message="closing the tc admin console and Removing all the clients" />
							<exec dir="${taskkill.dir}" executable="${taskkill.name}">
							         <arg line="/F /IM java.exe" />
						   </exec>
		</target>
	
</project>
   

